<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#B8956C">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <title>AI ì„¤ê³„ - ë‹¤ë‹´ê°€êµ¬</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600&family=Noto+Serif+KR:wght@400;500&display=swap" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    :root{--white:#FAFAFA;--cream:#F8F7F4;--warm:#EBE8E2;--gray:#8B8680;--charcoal:#2D2A26;--black:#1A1918;--gold:#B8956C;--gold-light:#D4B896}
    body{font-family:'Pretendard',-apple-system,BlinkMacSystemFont,system-ui,sans-serif;background:var(--white);color:var(--charcoal);line-height:1.7;-webkit-tap-highlight-color:transparent}
    h1,h2,h3,h4{font-family:'Playfair Display','Noto Serif KR',serif;font-weight:500}
    a{text-decoration:none;color:inherit}
    button{-webkit-tap-highlight-color:transparent}

    /* Navigation */
    .nav{position:fixed;top:0;left:0;right:0;z-index:100;padding:0 48px;height:72px;display:flex;align-items:center;justify-content:space-between;background:rgba(255,255,255,.97);backdrop-filter:blur(10px);box-shadow:0 1px 3px rgba(0,0,0,.08)}
    .nav-logo{display:flex;align-items:center;gap:8px;color:var(--charcoal)}
    .nav-logo svg{width:28px;height:28px}
    .nav-logo span{font-family:'Playfair Display',serif;font-size:22px}
    .nav-menu{display:flex;gap:28px}
    .nav-menu a{color:var(--charcoal);font-size:13px;letter-spacing:.5px;transition:all .3s}
    .nav-menu a:hover{opacity:.7}
    .nav-menu a.active{color:var(--gold);font-weight:500}
    .nav-icons{display:flex;align-items:center;gap:20px;color:var(--charcoal)}
    .nav-icons button{background:none;border:none;color:inherit;cursor:pointer;padding:4px}

    .hamburger{display:none;flex-direction:column;gap:5px;padding:8px;cursor:pointer;background:none;border:none}
    .hamburger span{width:24px;height:2px;background:var(--charcoal);border-radius:2px;transition:all .3s}
    .hamburger.active span:nth-child(1){transform:rotate(45deg) translate(5px,5px)}
    .hamburger.active span:nth-child(2){opacity:0}
    .hamburger.active span:nth-child(3){transform:rotate(-45deg) translate(5px,-5px)}

    .mobile-menu{position:fixed;top:64px;left:0;right:0;bottom:0;background:var(--white);z-index:99;padding:24px;display:none;flex-direction:column;gap:8px}
    .mobile-menu.active{display:flex}
    .mobile-menu a{padding:16px 20px;font-size:16px;border-radius:12px;transition:background .3s}
    .mobile-menu a:hover,.mobile-menu a.active{background:var(--cream);color:var(--gold)}

    /* Hero */
    .hero{padding:100px 48px 32px;background:linear-gradient(180deg,var(--cream) 0%,var(--white) 100%);text-align:center}
    .hero-badge{display:inline-flex;align-items:center;gap:6px;padding:6px 16px;background:rgba(184,149,108,.12);border-radius:20px;color:var(--gold);font-size:11px;letter-spacing:1.5px;text-transform:uppercase;margin-bottom:16px}
    .hero h1{font-size:36px;margin-bottom:10px}
    .hero h1 span{color:var(--gold)}
    .hero p{color:var(--gray);font-size:15px}

    .main-container{max-width:1100px;margin:0 auto;padding:0 24px 60px}

    /* Chat Box */
    .chat-box{background:var(--white);border:1px solid var(--warm);border-radius:16px;overflow:hidden;margin-bottom:32px;box-shadow:0 4px 20px rgba(0,0,0,.04)}
    .chat-header{padding:14px 20px;background:var(--cream);display:flex;align-items:center;gap:12px;border-bottom:1px solid var(--warm)}
    .chat-header-icon{width:36px;height:36px;background:linear-gradient(135deg,var(--gold),#D4A574);border-radius:10px;display:flex;align-items:center;justify-content:center;flex-shrink:0}
    .chat-header-icon svg{width:18px;height:18px;color:#fff}
    .chat-header-text h3{font-size:15px;font-family:inherit;font-weight:600}
    .chat-header-text p{font-size:11px;color:var(--gray)}
    .chat-status{margin-left:auto;display:flex;align-items:center;gap:5px;font-size:11px;color:var(--gray)}
    .chat-status::before{content:'';width:7px;height:7px;background:#4CAF50;border-radius:50%}
    .chat-messages{height:120px;padding:16px 20px;overflow-y:auto;display:flex;flex-direction:column;gap:10px;background:var(--white)}
    .message{display:flex;gap:10px;max-width:85%}
    .message.user{flex-direction:row-reverse;margin-left:auto}
    .message-avatar{width:28px;height:28px;border-radius:8px;display:flex;align-items:center;justify-content:center;flex-shrink:0}
    .message.ai .message-avatar{background:linear-gradient(135deg,var(--gold),#D4A574)}
    .message.ai .message-avatar svg{width:14px;height:14px;color:#fff}
    .message.user .message-avatar{background:var(--charcoal)}
    .message.user .message-avatar svg{width:14px;height:14px;color:#fff}
    .message-content{padding:10px 14px;border-radius:12px;font-size:13px;line-height:1.6}
    .message.ai .message-content{background:var(--cream);border-bottom-left-radius:4px}
    .message.user .message-content{background:var(--charcoal);color:#fff;border-bottom-right-radius:4px}
    .welcome-msg{text-align:center;padding:16px;color:var(--gray);font-size:13px}
    .welcome-msg strong{color:var(--charcoal);display:block;margin-bottom:4px}
    .chat-input{padding:14px 20px;border-top:1px solid var(--warm);background:var(--cream);display:flex;gap:10px}
    .chat-input input{flex:1;padding:12px 14px;border:1px solid var(--warm);border-radius:10px;font-size:16px;background:var(--white)}
    .chat-input input:focus{outline:none;border-color:var(--gold)}
    .chat-input button{width:44px;height:44px;background:var(--charcoal);border:none;border-radius:10px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:background .3s;flex-shrink:0}
    .chat-input button:hover{background:var(--gold)}
    .chat-input button svg{width:18px;height:18px;color:#fff}

    /* Section Title */
    .section-title{font-size:14px;color:var(--gray);text-transform:uppercase;letter-spacing:1.5px;margin-bottom:16px;text-align:center}
    .section-subtitle{text-align:center;color:var(--gold);font-size:12px;margin-top:-12px;margin-bottom:16px}

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       CATEGORY GRID - ë‹¤ì¤‘ ì„ íƒ ê°€ëŠ¥
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .category-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px;margin-bottom:24px}
    .category-card{background:var(--white);border:2px solid var(--warm);border-radius:16px;padding:20px 12px;text-align:center;cursor:pointer;transition:all .3s;position:relative;overflow:hidden}
    .category-card:hover{border-color:var(--gold);transform:translateY(-2px)}
    .category-card:active{transform:scale(0.98)}
    .category-card.selected{border-color:var(--gold);background:linear-gradient(135deg,rgba(184,149,108,.08),rgba(212,181,150,.08))}
    .category-card.has-image{border-color:var(--gold)}
    .category-card.has-image::after{content:'âœ“';position:absolute;top:8px;right:8px;width:22px;height:22px;background:var(--gold);color:#fff;border-radius:50%;font-size:12px;display:flex;align-items:center;justify-content:center}
    .category-icon{font-size:32px;margin-bottom:8px;display:block}
    .category-name{font-size:14px;font-weight:600;color:var(--charcoal);margin-bottom:2px}
    .category-desc{font-size:10px;color:var(--gray)}
    .category-preview{width:100%;height:70px;object-fit:cover;border-radius:8px;margin-bottom:6px;display:none}
    .category-card.has-image .category-preview{display:block}
    .category-card.has-image .category-icon{display:none}
    .file-input{display:none}

    /* Selected Count Badge */
    .selected-count{display:inline-flex;align-items:center;gap:6px;padding:8px 16px;background:var(--gold);color:#fff;border-radius:20px;font-size:13px;margin-bottom:20px}
    .selected-count.hidden{display:none}

    /* Style Selector */
    .style-selector{display:flex;justify-content:center;gap:10px;margin-bottom:20px;flex-wrap:wrap;padding:0 10px}
    .style-chip{padding:10px 16px;background:var(--white);border:1px solid var(--warm);border-radius:20px;font-size:13px;cursor:pointer;transition:all .3s;white-space:nowrap}
    .style-chip:hover{border-color:var(--gold)}
    .style-chip:active{transform:scale(0.95)}
    .style-chip.active{background:var(--gold);color:#fff;border-color:var(--gold)}

    /* Action Buttons */
    .action-buttons{display:flex;gap:12px;justify-content:center;margin-bottom:32px;flex-wrap:wrap;padding:0 16px}
    .action-btn{flex:1;max-width:280px;padding:16px 24px;border:none;border-radius:14px;font-size:15px;font-weight:600;cursor:pointer;transition:all .3s;display:flex;align-items:center;justify-content:center;gap:8px}
    .action-btn:disabled{opacity:.6;cursor:not-allowed;transform:none}
    .action-btn .spinner{width:18px;height:18px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:spin 1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}

    .analyze-btn{background:var(--charcoal);color:#fff}
    .analyze-btn:hover:not(:disabled){background:#3d3a36;transform:translateY(-2px);box-shadow:0 4px 16px rgba(0,0,0,.2)}
    
    .generate-btn{background:linear-gradient(135deg,var(--gold),var(--gold-light));color:#fff;box-shadow:0 4px 16px rgba(184,149,108,.3)}
    .generate-btn:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 24px rgba(184,149,108,.4)}

    /* Progress Bar */
    .progress-container{display:none;margin-bottom:24px;padding:0 20px}
    .progress-container.active{display:block}
    .progress-bar{height:8px;background:var(--warm);border-radius:4px;overflow:hidden}
    .progress-fill{height:100%;background:linear-gradient(90deg,var(--gold),var(--gold-light));border-radius:4px;transition:width .3s;width:0%}
    .progress-text{text-align:center;font-size:13px;color:var(--gray);margin-top:8px}

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       WALL ANALYSIS SECTION
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .wall-analysis-section{background:var(--white);border:2px solid var(--warm);border-radius:20px;padding:24px;margin-bottom:32px;display:none}
    .wall-analysis-section.active{display:block}
    
    .wall-header{display:flex;align-items:center;gap:12px;margin-bottom:20px;padding-bottom:16px;border-bottom:1px solid var(--warm)}
    .wall-header h2{font-size:18px;display:flex;align-items:center;gap:10px}
    .wall-header .badge{padding:4px 12px;background:var(--charcoal);color:#fff;border-radius:12px;font-size:11px;font-family:sans-serif}
    
    .layout-type-display{text-align:center;padding:20px;background:linear-gradient(135deg,rgba(184,149,108,.1),rgba(212,184,150,.1));border-radius:14px;margin-bottom:20px}
    .layout-type-display .type{font-size:28px;font-weight:700;color:var(--charcoal)}
    .layout-type-display .label{font-size:12px;color:var(--gray);margin-top:4px}
    
    .wall-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px}
    .wall-card{background:var(--cream);border-radius:12px;padding:16px}
    .wall-card h4{font-size:13px;color:var(--gold);margin-bottom:10px;display:flex;align-items:center;gap:6px;font-family:inherit}
    .wall-card p{font-size:13px;color:var(--charcoal);line-height:1.6}
    .walls-list{display:flex;flex-direction:column;gap:8px}
    .wall-item{background:var(--white);border-radius:10px;padding:12px;border-left:4px solid var(--gold)}
    .wall-item .position{font-weight:600;color:var(--charcoal);font-size:12px;text-transform:uppercase;margin-bottom:6px}
    .wall-item .features{display:flex;flex-wrap:wrap;gap:4px}
    .wall-item .feature{padding:3px 8px;background:var(--cream);border-radius:8px;font-size:10px;color:var(--gray)}
    .wall-item .feature.active{background:var(--gold);color:#fff}
    .recommendations-card{background:var(--charcoal);color:#fff;border-radius:12px;padding:16px}
    .recommendations-card h4{color:var(--gold);margin-bottom:10px}
    .recommendations-card ul{list-style:none}
    .recommendations-card li{padding:5px 0;font-size:12px;border-bottom:1px solid rgba(255,255,255,.1)}
    .recommendations-card li:last-child{border:none}
    .recommendations-card li::before{content:'âœ“';color:var(--gold);margin-right:8px}

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       RESULT SECTION - í˜ì´ì§€ í˜•íƒœ
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    .result-section{background:var(--cream);border-radius:20px;padding:24px;min-height:300px}
    
    .result-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;flex-wrap:wrap;gap:12px}
    .result-header h2{font-size:18px;display:flex;align-items:center;gap:10px}
    .result-header h2 span{font-size:11px;padding:4px 10px;background:var(--gold);color:#fff;border-radius:10px;font-family:sans-serif}
    .result-actions{display:flex;gap:8px}
    .result-btn{padding:10px 14px;border-radius:10px;font-size:12px;font-weight:500;cursor:pointer;transition:all .3s;display:flex;align-items:center;gap:6px}
    .result-btn.download{background:var(--charcoal);color:#fff;border:none}
    .result-btn.download:hover{background:var(--gold)}
    .result-btn.share{background:transparent;color:var(--charcoal);border:1px solid var(--charcoal)}
    .result-btn.share:hover{background:var(--charcoal);color:#fff}
    .result-btn:disabled{opacity:.5;cursor:not-allowed}

    /* Page Navigation */
    .page-nav{display:flex;align-items:center;justify-content:center;gap:12px;margin-bottom:20px}
    .page-nav.hidden{display:none}
    .page-arrow{width:40px;height:40px;border-radius:50%;border:1px solid var(--warm);background:var(--white);cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .3s}
    .page-arrow:hover:not(:disabled){background:var(--gold);border-color:var(--gold);color:#fff}
    .page-arrow:disabled{opacity:.4;cursor:not-allowed}
    .page-arrow svg{width:20px;height:20px}
    .page-indicator{display:flex;gap:8px;align-items:center}
    .page-dot{width:10px;height:10px;border-radius:50%;background:var(--warm);cursor:pointer;transition:all .3s}
    .page-dot.active{background:var(--gold);width:24px;border-radius:5px}
    .page-dot:hover{background:var(--gold)}
    .page-info{font-size:14px;color:var(--gray);min-width:60px;text-align:center}
    .page-info span{color:var(--charcoal);font-weight:600}

    /* Result Pages Container */
    .result-pages{position:relative;overflow:hidden}
    .result-page{display:none}
    .result-page.active{display:block;animation:fadeIn .3s ease}
    @keyframes fadeIn{from{opacity:0;transform:translateX(20px)}to{opacity:1;transform:translateX(0)}}

    /* Page Category Label */
    .page-category{display:inline-flex;align-items:center;gap:8px;padding:8px 16px;background:var(--white);border-radius:12px;margin-bottom:16px;font-size:14px;font-weight:600;color:var(--charcoal);box-shadow:0 2px 8px rgba(0,0,0,.06)}
    .page-category .icon{font-size:20px}

    .result-grid{display:grid;grid-template-columns:1fr 1fr;gap:16px;margin-bottom:16px}
    .result-card{background:var(--white);border-radius:14px;overflow:hidden;box-shadow:0 2px 10px rgba(0,0,0,.05)}
    .result-card-header{padding:10px 14px;background:var(--white);border-bottom:1px solid var(--warm);display:flex;align-items:center;gap:6px}
    .result-card-header .dot{width:8px;height:8px;border-radius:50%}
    .result-card-header .dot.before{background:#ef4444}
    .result-card-header .dot.after{background:#10b981}
    .result-card-header span{font-size:11px;font-weight:600;color:var(--gray);text-transform:uppercase;letter-spacing:1px}
    .result-card img{width:100%;height:220px;object-fit:cover;display:block}
    
    .result-analysis{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .analysis-card{background:var(--white);border-radius:12px;padding:16px;box-shadow:0 2px 8px rgba(0,0,0,.04)}
    .analysis-card h4{font-size:12px;color:var(--gold);margin-bottom:6px;display:flex;align-items:center;gap:6px;font-family:inherit}
    .analysis-card p{font-size:12px;color:var(--charcoal);line-height:1.6}

    /* Placeholder & Loading */
    .result-placeholder{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;padding:60px 20px;color:var(--gray)}
    .result-placeholder .icon{font-size:56px;margin-bottom:16px;opacity:.4}
    .result-placeholder h3{font-size:17px;color:var(--charcoal);margin-bottom:8px;font-family:inherit}
    .result-placeholder p{font-size:13px;max-width:300px}
    .result-placeholder.hidden{display:none}

    .result-loading{display:none;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;text-align:center}
    .result-loading.active{display:flex}
    .result-loading .spinner{width:48px;height:48px;border:3px solid var(--warm);border-top-color:var(--gold);border-radius:50%;animation:spin 1s linear infinite;margin-bottom:20px}
    .result-loading h3{font-size:17px;color:var(--charcoal);margin-bottom:8px}
    .result-loading p{font-size:13px;color:var(--gray)}

    /* Footer */
    .footer{padding:48px;background:var(--charcoal);color:#fff;margin-top:60px}
    .footer-content{max-width:1100px;margin:0 auto;display:flex;justify-content:space-between;align-items:center}
    .footer-brand{display:flex;align-items:center;gap:8px}
    .footer-brand svg{width:24px;height:24px}
    .footer-brand span{font-family:'Playfair Display',serif;font-size:18px}
    .footer-links{display:flex;gap:24px}
    .footer-links a{color:rgba(255,255,255,.6);font-size:13px;transition:color .3s}
    .footer-links a:hover{color:#fff}
    .footer-copy{text-align:center;margin-top:24px;padding-top:20px;border-top:1px solid rgba(255,255,255,.1);font-size:11px;color:rgba(255,255,255,.4)}

    /* Toast */
    .toast{position:fixed;bottom:24px;left:50%;transform:translateX(-50%) translateY(100px);background:var(--charcoal);color:#fff;padding:14px 24px;border-radius:12px;font-size:14px;z-index:1000;transition:transform .3s;max-width:90%}
    .toast.show{transform:translateX(-50%) translateY(0)}
    .toast.success{background:#10b981}
    .toast.error{background:#ef4444}

    /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
       RESPONSIVE
       â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
    @media(max-width:1024px){
      .nav{padding:0 32px}
      .hero{padding:100px 32px 28px}
      .main-container{padding:0 20px 50px}
    }

    @media(max-width:768px){
      .nav{padding:0 16px;height:64px}
      .nav-logo span{font-size:20px}
      .nav-menu{display:none}
      .hamburger{display:flex}
      
      .hero{padding:84px 16px 20px}
      .hero h1{font-size:28px}
      .hero p{font-size:14px}
      
      .main-container{padding:0 12px 40px}
      
      .chat-box{margin-bottom:20px}
      .chat-messages{height:100px}
      
      .category-grid{grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:20px}
      .category-card{padding:14px 10px}
      .category-icon{font-size:26px}
      .category-name{font-size:13px}
      .category-desc{font-size:9px}
      .category-preview{height:60px}
      
      .style-selector{gap:8px;overflow-x:auto;flex-wrap:nowrap;justify-content:flex-start;padding:0 12px 8px;-webkit-overflow-scrolling:touch}
      .style-chip{padding:8px 14px;font-size:12px;flex-shrink:0}
      
      .action-buttons{flex-direction:column;gap:10px}
      .action-btn{max-width:100%;padding:14px 20px;font-size:14px}
      
      .wall-analysis-section{padding:16px}
      .layout-type-display .type{font-size:24px}
      .wall-grid{grid-template-columns:1fr}
      
      .result-section{padding:16px}
      .result-grid{grid-template-columns:1fr}
      .result-card img{height:180px}
      .result-analysis{grid-template-columns:1fr}
      
      .page-nav{gap:8px}
      .page-arrow{width:36px;height:36px}
      
      .footer{padding:32px 16px}
      .footer-content{flex-direction:column;gap:20px;text-align:center}
      .footer-links{flex-wrap:wrap;justify-content:center}
    }

    @media(max-width:480px){
      .nav{height:56px}
      .hero{padding:72px 12px 16px}
      .hero h1{font-size:24px}
      .category-grid{gap:8px}
      .category-icon{font-size:22px}
      .category-name{font-size:12px}
      .category-desc{display:none}
      .category-preview{height:50px}
      .result-card img{height:150px}
    }

    @media(hover:none){
      .category-card:hover{transform:none}
      .action-btn:hover:not(:disabled){transform:none}
    }

    @supports(padding:max(0px)){
      .nav{padding-left:max(16px,env(safe-area-inset-left));padding-right:max(16px,env(safe-area-inset-right))}
      .main-container{padding-left:max(12px,env(safe-area-inset-left));padding-right:max(12px,env(safe-area-inset-right))}
      .toast{bottom:max(24px,env(safe-area-inset-bottom))}
    }
  </style>
</head>
<body>
  <!-- SVG Symbols -->
  <svg style="display:none">
    <symbol id="icon-logo" viewBox="0 0 40 40"><path d="M20 4L4 12v16l16 8 16-8V12L20 4zm0 4l12 6-12 6-12-6 12-6zm-12 10l12 6 12-6v8l-12 6-12-6v-8z"/></symbol>
    <symbol id="icon-ai" viewBox="0 0 24 24"><path fill="currentColor" d="M12 2a2 2 0 0 1 2 2c0 .74-.4 1.39-1 1.73V7h1a7 7 0 0 1 7 7h1a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v1a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-1H2a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h1a7 7 0 0 1 7-7h1V5.73c-.6-.34-1-.99-1-1.73a2 2 0 0 1 2-2M7.5 13A2.5 2.5 0 0 0 5 15.5 2.5 2.5 0 0 0 7.5 18a2.5 2.5 0 0 0 2.5-2.5A2.5 2.5 0 0 0 7.5 13m9 0a2.5 2.5 0 0 0-2.5 2.5 2.5 2.5 0 0 0 2.5 2.5 2.5 2.5 0 0 0 2.5-2.5 2.5 2.5 0 0 0-2.5-2.5z"/></symbol>
    <symbol id="icon-user" viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></symbol>
    <symbol id="icon-send" viewBox="0 0 24 24"><path d="M22 2L11 13M22 2l-7 20-4-9-9-4 20-7z"/></symbol>
    <symbol id="icon-sparkle" viewBox="0 0 24 24"><path d="M12 2l2.4 7.2L22 12l-7.6 2.8L12 22l-2.4-7.2L2 12l7.6-2.8L12 2z"/></symbol>
    <symbol id="icon-download" viewBox="0 0 24 24"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4M7 10l5 5 5-5M12 15V3"/></symbol>
    <symbol id="icon-share" viewBox="0 0 24 24"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><path d="m8.59 13.51 6.83 3.98M15.41 6.51l-6.82 3.98"/></symbol>
    <symbol id="icon-chevron-left" viewBox="0 0 24 24"><path d="m15 18-6-6 6-6" fill="none" stroke="currentColor" stroke-width="2"/></symbol>
    <symbol id="icon-chevron-right" viewBox="0 0 24 24"><path d="m9 18 6-6-6-6" fill="none" stroke="currentColor" stroke-width="2"/></symbol>
  </svg>

  <!-- Navigation -->
  <nav class="nav">
    <a href="index.html" class="nav-logo">
      <svg fill="currentColor"><use href="#icon-logo"/></svg>
      <span>ë‹¤ë‹´</span>
    </a>
    <div class="nav-menu">
      <a href="index.html">About us</a>
      <a href="index.html">Collection</a>
      <a href="index.html">Products</a>
      <a href="ai-design.html" class="active">AI Design</a>
      <a href="index.html">Stories</a>
      <a href="index.html">Showroom</a>
      <a href="index.html">Service</a>
    </div>
    <div class="nav-icons">
      <button class="hamburger" onclick="toggleMobileMenu()" aria-label="ë©”ë‰´">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </nav>

  <!-- Mobile Menu -->
  <div class="mobile-menu" id="mobileMenu">
    <a href="index.html">About us</a>
    <a href="index.html">Collection</a>
    <a href="index.html">Products</a>
    <a href="ai-design.html" class="active">AI Design</a>
    <a href="index.html">Stories</a>
    <a href="index.html">Showroom</a>
    <a href="index.html">Service</a>
  </div>

  <!-- Hero -->
  <section class="hero">
    <div class="hero-badge">
      <svg width="14" height="14" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-sparkle"/></svg>
      AI-Powered Design
    </div>
    <h1>AI <span>ì„¤ê³„</span> ì‹œìŠ¤í…œ</h1>
    <p>ì—¬ëŸ¬ ê³µê°„ì„ í•œ ë²ˆì— ë””ìì¸í•˜ì„¸ìš”</p>
  </section>

  <!-- Main Container -->
  <main class="main-container">
    
    <!-- AI Chat Box -->
    <div class="chat-box">
      <div class="chat-header">
        <div class="chat-header-icon">
          <svg><use href="#icon-ai"/></svg>
        </div>
        <div class="chat-header-text">
          <h3>ë‹¤ë‹´ AI ì„¤ê³„ì‚¬</h3>
          <p>ë§ì¶¤ ê°€êµ¬ ì„¤ê³„ ì „ë¬¸ AI</p>
        </div>
        <div class="chat-status">ì˜¨ë¼ì¸</div>
      </div>
      <div class="chat-messages" id="chatMessages">
        <div class="welcome-msg">
          <strong>ğŸ‘‹ ì•ˆë…•í•˜ì„¸ìš”!</strong>
          ì—¬ëŸ¬ ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•˜ê³  ê°ê° ì‚¬ì§„ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.
        </div>
      </div>
      <div class="chat-input">
        <input type="text" id="messageInput" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." onkeydown="if(event.key==='Enter')sendMessage()">
        <button onclick="sendMessage()" aria-label="ì „ì†¡">
          <svg fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-send"/></svg>
        </button>
      </div>
    </div>

    <!-- Category Grid -->
    <p class="section-title">ì¹´í…Œê³ ë¦¬ ì„ íƒ</p>
    <p class="section-subtitle">ğŸ’¡ ì—¬ëŸ¬ ê°œ ì„ íƒ ê°€ëŠ¥ - í´ë¦­í•˜ì—¬ ì‚¬ì§„ ì—…ë¡œë“œ</p>
    
    <div style="text-align:center">
      <div class="selected-count hidden" id="selectedCount">ğŸ“· <span>0</span>ê°œ ì´ë¯¸ì§€ ì—…ë¡œë“œë¨</div>
    </div>
    
    <div class="category-grid">
      <div class="category-card" data-category="sink" onclick="selectCategory('sink')">
        <img class="category-preview" id="preview-sink" src="" alt="">
        <span class="category-icon">ğŸ³</span>
        <div class="category-name">ì‹±í¬ëŒ€</div>
        <div class="category-desc">ì£¼ë°© ì‹±í¬ëŒ€ & ìƒí•˜ë¶€ì¥</div>
      </div>
      <div class="category-card" data-category="wardrobe" onclick="selectCategory('wardrobe')">
        <img class="category-preview" id="preview-wardrobe" src="" alt="">
        <span class="category-icon">ğŸ‘”</span>
        <div class="category-name">ë¶™ë°•ì´ì¥</div>
        <div class="category-desc">ì˜·ì¥ & ìˆ˜ë‚© ì‹œìŠ¤í…œ</div>
      </div>
      <div class="category-card" data-category="fridge" onclick="selectCategory('fridge')">
        <img class="category-preview" id="preview-fridge" src="" alt="">
        <span class="category-icon">ğŸ§Š</span>
        <div class="category-name">ëƒ‰ì¥ê³ ì¥</div>
        <div class="category-desc">ëƒ‰ì¥ê³ ì¥ & í‚¤í°ì¥</div>
      </div>
      <div class="category-card" data-category="vanity" onclick="selectCategory('vanity')">
        <img class="category-preview" id="preview-vanity" src="" alt="">
        <span class="category-icon">ğŸ’„</span>
        <div class="category-name">í™”ì¥ëŒ€</div>
        <div class="category-desc">ë“œë ˆì„œ & í™”ì¥ëŒ€</div>
      </div>
      <div class="category-card" data-category="shoe" onclick="selectCategory('shoe')">
        <img class="category-preview" id="preview-shoe" src="" alt="">
        <span class="category-icon">ğŸ‘Ÿ</span>
        <div class="category-name">ì‹ ë°œì¥</div>
        <div class="category-desc">í˜„ê´€ ì‹ ë°œì¥ & ìˆ˜ë‚©</div>
      </div>
      <div class="category-card" data-category="storage" onclick="selectCategory('storage')">
        <img class="category-preview" id="preview-storage" src="" alt="">
        <span class="category-icon">ğŸ“¦</span>
        <div class="category-name">ììœ  ìˆ˜ë‚©ì¥</div>
        <div class="category-desc">ë‹¤ìš©ë„ ìˆ˜ë‚© ê°€êµ¬</div>
      </div>
    </div>

    <!-- Hidden File Inputs -->
    <input type="file" class="file-input" id="file-sink" accept="image/*" onchange="handleFileUpload('sink', this)">
    <input type="file" class="file-input" id="file-wardrobe" accept="image/*" onchange="handleFileUpload('wardrobe', this)">
    <input type="file" class="file-input" id="file-fridge" accept="image/*" onchange="handleFileUpload('fridge', this)">
    <input type="file" class="file-input" id="file-vanity" accept="image/*" onchange="handleFileUpload('vanity', this)">
    <input type="file" class="file-input" id="file-shoe" accept="image/*" onchange="handleFileUpload('shoe', this)">
    <input type="file" class="file-input" id="file-storage" accept="image/*" onchange="handleFileUpload('storage', this)">

    <!-- Style Selector -->
    <div class="style-selector">
      <div class="style-chip active" data-style="ëª¨ë˜" onclick="selectStyle(this)">ğŸ¢ ëª¨ë˜</div>
      <div class="style-chip" data-style="ìŠ¤ì¹¸ë””ë‚˜ë¹„ì•ˆ" onclick="selectStyle(this)">ğŸŒ² ìŠ¤ì¹¸ë””ë‚˜ë¹„ì•ˆ</div>
      <div class="style-chip" data-style="ì¸ë”ìŠ¤íŠ¸ë¦¬ì–¼" onclick="selectStyle(this)">ğŸ­ ì¸ë”ìŠ¤íŠ¸ë¦¬ì–¼</div>
      <div class="style-chip" data-style="ë¯¸ë‹ˆë©€" onclick="selectStyle(this)">â—»ï¸ ë¯¸ë‹ˆë©€</div>
      <div class="style-chip" data-style="ëŸ­ì…”ë¦¬" onclick="selectStyle(this)">âœ¨ ëŸ­ì…”ë¦¬</div>
    </div>

    <!-- Action Buttons -->
    <div class="action-buttons">
      <button class="action-btn analyze-btn" id="analyzeBtn" onclick="analyzeAllWalls()" disabled>
        ğŸ§± ì „ì²´ ë²½ êµ¬ì¡° ë¶„ì„
      </button>
      <button class="action-btn generate-btn" id="generateBtn" onclick="generateAllDesigns()" disabled>
        âœ¨ AI ë””ìì¸ ìƒì„±
      </button>
    </div>

    <!-- Progress Bar -->
    <div class="progress-container" id="progressContainer">
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
      </div>
      <p class="progress-text" id="progressText">ì²˜ë¦¬ ì¤‘...</p>
    </div>

    <!-- Wall Analysis Section -->
    <section class="wall-analysis-section" id="wallAnalysisSection">
      <div class="wall-header">
        <h2>ğŸ“ ë²½ êµ¬ì¡° ë¶„ì„ ê²°ê³¼ <span class="badge">Claude Vision</span></h2>
      </div>
      <div class="layout-type-display">
        <div class="type" id="layoutType">-</div>
        <div class="label">ê³µê°„ ë ˆì´ì•„ì›ƒ</div>
      </div>
      <div class="wall-grid">
        <div class="wall-card">
          <h4>ğŸ§± ë²½ë©´ ì •ë³´</h4>
          <div class="walls-list" id="wallsList"></div>
        </div>
        <div class="wall-card recommendations-card">
          <h4>ğŸ’¡ ìºë¹„ë„· ë°°ì¹˜ ì¶”ì²œ</h4>
          <ul id="recommendationsList"></ul>
        </div>
        <div class="wall-card">
          <h4>âš ï¸ ì¥ì• ë¬¼ / ì£¼ì˜ì‚¬í•­</h4>
          <p id="obstaclesList">-</p>
        </div>
        <div class="wall-card">
          <h4>ğŸ“ ì¶”ê°€ ë¶„ì„</h4>
          <p id="analysisNotes">-</p>
        </div>
      </div>
    </section>

    <!-- Result Section -->
    <section class="result-section">
      <div class="result-header">
        <h2>ğŸ–¼ï¸ ë¦¬ë””ìì¸ ê²°ê³¼ <span>DALL-E 3</span></h2>
        <div class="result-actions">
          <button class="result-btn download" id="downloadBtn" onclick="downloadCurrentImage()" disabled>
            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-download"/></svg>
            ë‹¤ìš´ë¡œë“œ
          </button>
          <button class="result-btn share" id="shareBtn" onclick="shareResult()" disabled>
            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2"><use href="#icon-share"/></svg>
            ê³µìœ 
          </button>
        </div>
      </div>

      <!-- Page Navigation -->
      <div class="page-nav hidden" id="pageNav">
        <button class="page-arrow" id="prevPage" onclick="changePage(-1)">
          <svg><use href="#icon-chevron-left"/></svg>
        </button>
        <div class="page-indicator" id="pageIndicator"></div>
        <div class="page-info"><span id="currentPage">1</span> / <span id="totalPages">1</span></div>
        <button class="page-arrow" id="nextPage" onclick="changePage(1)">
          <svg><use href="#icon-chevron-right"/></svg>
        </button>
      </div>

      <!-- Placeholder -->
      <div class="result-placeholder" id="resultPlaceholder">
        <div class="icon">ğŸ¨</div>
        <h3>ë””ìì¸ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤</h3>
        <p>ì—¬ëŸ¬ ì¹´í…Œê³ ë¦¬ë¥¼ ì„ íƒí•˜ê³  ì‚¬ì§„ì„ ì—…ë¡œë“œí•œ í›„ ìƒì„± ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”</p>
      </div>

      <!-- Loading -->
      <div class="result-loading" id="resultLoading">
        <div class="spinner"></div>
        <h3 id="loadingTitle">AIê°€ ë””ìì¸ ì¤‘...</h3>
        <p id="loadingText">ì•½ 20-30ì´ˆ ì†Œìš”</p>
      </div>

      <!-- Result Pages Container -->
      <div class="result-pages" id="resultPages"></div>
    </section>

  </main>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-content">
      <a href="index.html" class="footer-brand">
        <svg fill="currentColor"><use href="#icon-logo"/></svg>
        <span>ë‹¤ë‹´</span>
      </a>
      <div class="footer-links">
        <a href="index.html">í™ˆ</a>
        <a href="#">ì œí’ˆ</a>
        <a href="#">ì‹œê³µì‚¬ë¡€</a>
        <a href="#">ì‡¼ë£¸</a>
        <a href="#">ê³ ê°ì„¼í„°</a>
      </div>
    </div>
    <p class="footer-copy">Â© 2024 ë‹¤ë‹´ê°€êµ¬. All rights reserved.</p>
  </footer>

  <!-- Toast -->
  <div class="toast" id="toast"></div>

  <script>
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // API URLs
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    const N8N_CHAT_URL = 'https://dadam.app.n8n.cloud/webhook/chat';
    const N8N_INTERIOR_URL = 'https://dadam.app.n8n.cloud/webhook/interior-design';
    const N8N_WALL_ANALYSIS_URL = 'https://dadam.app.n8n.cloud/webhook/wall-analysis';
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // State
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    const state = {
      selectedStyle: 'ëª¨ë˜',
      uploadedImages: {},  // { category: { base64, preview, type } }
      results: [],         // [{ category, beforeUrl, afterUrl, analysis, suggestions }]
      currentPage: 0
    };

    const categoryInfo = {
      sink: { name: 'ì‹±í¬ëŒ€', icon: 'ğŸ³' },
      wardrobe: { name: 'ë¶™ë°•ì´ì¥', icon: 'ğŸ‘”' },
      fridge: { name: 'ëƒ‰ì¥ê³ ì¥', icon: 'ğŸ§Š' },
      vanity: { name: 'í™”ì¥ëŒ€', icon: 'ğŸ’„' },
      shoe: { name: 'ì‹ ë°œì¥', icon: 'ğŸ‘Ÿ' },
      storage: { name: 'ììœ  ìˆ˜ë‚©ì¥', icon: 'ğŸ“¦' }
    };

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Mobile Menu
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function toggleMobileMenu() {
      const hamburger = document.querySelector('.hamburger');
      const mobileMenu = document.getElementById('mobileMenu');
      hamburger.classList.toggle('active');
      mobileMenu.classList.toggle('active');
      document.body.style.overflow = mobileMenu.classList.contains('active') ? 'hidden' : '';
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Category Selection & File Upload
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function selectCategory(category) {
      document.getElementById(`file-${category}`).click();
    }

    function handleFileUpload(category, input) {
      const file = input.files[0];
      if (!file) return;
      
      const reader = new FileReader();
      reader.onload = (e) => {
        const base64Full = e.target.result;
        const base64Data = base64Full.split(',')[1];
        
        state.uploadedImages[category] = {
          base64: base64Data,
          preview: base64Full,
          type: file.type || 'image/jpeg'
        };
        
        // Update UI
        document.getElementById(`preview-${category}`).src = base64Full;
        document.querySelector(`[data-category="${category}"]`).classList.add('has-image');
        
        updateSelectedCount();
        updateButtons();
        
        showToast(`${categoryInfo[category].name} ì´ë¯¸ì§€ ì—…ë¡œë“œ ì™„ë£Œ!`, 'success');
        addChatMessage(`${categoryInfo[category].icon} ${categoryInfo[category].name} ì´ë¯¸ì§€ê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.`, false);
      };
      reader.readAsDataURL(file);
    }

    function updateSelectedCount() {
      const count = Object.keys(state.uploadedImages).length;
      const countEl = document.getElementById('selectedCount');
      countEl.querySelector('span').textContent = count;
      countEl.classList.toggle('hidden', count === 0);
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Style Selection
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function selectStyle(el) {
      document.querySelectorAll('.style-chip').forEach(c => c.classList.remove('active'));
      el.classList.add('active');
      state.selectedStyle = el.dataset.style;
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Button State
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function updateButtons() {
      const hasImages = Object.keys(state.uploadedImages).length > 0;
      document.getElementById('analyzeBtn').disabled = !hasImages;
      document.getElementById('generateBtn').disabled = !hasImages;
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Progress Bar
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function showProgress(current, total, text) {
      const container = document.getElementById('progressContainer');
      const fill = document.getElementById('progressFill');
      const textEl = document.getElementById('progressText');
      
      container.classList.add('active');
      fill.style.width = `${(current / total) * 100}%`;
      textEl.textContent = text;
    }

    function hideProgress() {
      document.getElementById('progressContainer').classList.remove('active');
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // WALL ANALYSIS (First uploaded image)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    async function analyzeAllWalls() {
      const categories = Object.keys(state.uploadedImages);
      if (categories.length === 0) {
        showToast('ì´ë¯¸ì§€ë¥¼ ë¨¼ì € ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.', 'error');
        return;
      }

      const btn = document.getElementById('analyzeBtn');
      btn.disabled = true;
      btn.innerHTML = '<div class="spinner"></div> ë¶„ì„ ì¤‘...';

      // Analyze first image for wall structure
      const firstCategory = categories[0];
      const imageData = state.uploadedImages[firstCategory];

      try {
        const response = await fetch(N8N_WALL_ANALYSIS_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            room_image: imageData.base64,
            image_type: imageData.type
          })
        });

        if (!response.ok) throw new Error(`HTTP ${response.status}`);

        let data = await response.json();
        if (Array.isArray(data)) data = data[0];

        displayWallAnalysis(data);
        document.getElementById('wallAnalysisSection').classList.add('active');
        document.getElementById('wallAnalysisSection').scrollIntoView({ behavior: 'smooth' });
        
        showToast('ë²½ êµ¬ì¡° ë¶„ì„ ì™„ë£Œ!', 'success');
        addChatMessage(`ë²½ êµ¬ì¡° ë¶„ì„ ì™„ë£Œ! ${data.layout_type || 'ê³µê°„'} í˜•íƒœì…ë‹ˆë‹¤.`, false);

      } catch (error) {
        console.error('Wall Analysis Error:', error);
        showToast('ë²½ ë¶„ì„ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
      }

      btn.disabled = false;
      btn.innerHTML = 'ğŸ§± ì „ì²´ ë²½ êµ¬ì¡° ë¶„ì„';
      updateButtons();
    }

    function displayWallAnalysis(data) {
      document.getElementById('layoutType').textContent = data.layout_type || 'ë¶„ì„ ë¶ˆê°€';
      
      const wallsList = document.getElementById('wallsList');
      if (data.walls && data.walls.length > 0) {
        wallsList.innerHTML = data.walls.map(wall => {
          const features = wall.features || {};
          return `
            <div class="wall-item">
              <div class="position">${getWallPositionKR(wall.position)} ë²½ë©´</div>
              <div class="features">
                <span class="feature ${features.has_window ? 'active' : ''}">ğŸªŸ ì°½ë¬¸</span>
                <span class="feature ${features.has_door ? 'active' : ''}">ğŸšª ë¬¸</span>
                <span class="feature ${features.has_outlet ? 'active' : ''}">ğŸ”Œ ì½˜ì„¼íŠ¸</span>
                <span class="feature ${features.has_pipe ? 'active' : ''}">ğŸ”§ ë°°ê´€</span>
              </div>
            </div>
          `;
        }).join('');
      } else {
        wallsList.innerHTML = '<p style="color:#999;font-size:12px;">ë²½ë©´ ì •ë³´ ì—†ìŒ</p>';
      }
      
      const recommendationsList = document.getElementById('recommendationsList');
      if (data.recommended_cabinet_walls && data.recommended_cabinet_walls.length > 0) {
        recommendationsList.innerHTML = data.recommended_cabinet_walls.map(wall => 
          `<li>${getWallPositionKR(wall)} ë²½ë©´ì— ìºë¹„ë„· ë°°ì¹˜ ì¶”ì²œ</li>`
        ).join('');
      } else {
        recommendationsList.innerHTML = '<li>ì¶”ì²œ ì •ë³´ ì—†ìŒ</li>';
      }
      
      document.getElementById('obstaclesList').textContent = data.obstacles?.length > 0 
        ? data.obstacles.join(', ') : 'ë°œê²¬ëœ ì¥ì• ë¬¼ ì—†ìŒ';
      document.getElementById('analysisNotes').textContent = data.analysis_notes || 'ì¶”ê°€ ë¶„ì„ ì •ë³´ ì—†ìŒ';
    }

    function getWallPositionKR(position) {
      const map = { 'left': 'ì¢Œì¸¡', 'front': 'ì •ë©´', 'right': 'ìš°ì¸¡', 'back': 'í›„ë©´' };
      return map[position?.toLowerCase()] || position || 'ì•Œ ìˆ˜ ì—†ìŒ';
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // GENERATE ALL DESIGNS
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    async function generateAllDesigns() {
      const categories = Object.keys(state.uploadedImages);
      if (categories.length === 0) {
        showToast('ì´ë¯¸ì§€ë¥¼ ë¨¼ì € ì—…ë¡œë“œí•´ì£¼ì„¸ìš”.', 'error');
        return;
      }

      const btn = document.getElementById('generateBtn');
      const placeholder = document.getElementById('resultPlaceholder');
      const loading = document.getElementById('resultLoading');
      const pagesContainer = document.getElementById('resultPages');

      btn.disabled = true;
      btn.innerHTML = '<div class="spinner"></div> ìƒì„± ì¤‘...';
      placeholder.classList.add('hidden');
      pagesContainer.innerHTML = '';
      loading.classList.add('active');

      state.results = [];
      const total = categories.length;

      for (let i = 0; i < categories.length; i++) {
        const category = categories[i];
        const imageData = state.uploadedImages[category];
        
        showProgress(i + 1, total, `${categoryInfo[category].name} ë””ìì¸ ìƒì„± ì¤‘... (${i + 1}/${total})`);
        document.getElementById('loadingTitle').textContent = `${categoryInfo[category].icon} ${categoryInfo[category].name} ë””ìì¸ ì¤‘...`;
        document.getElementById('loadingText').textContent = `${i + 1} / ${total} ì²˜ë¦¬ ì¤‘`;

        try {
          const response = await fetch(N8N_INTERIOR_URL, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
              room_image: imageData.base64,
              image_type: imageData.type,
              design_style: state.selectedStyle,
              additional_request: `${categoryInfo[category].name} ë¦¬ë””ìì¸`
            })
          });

          if (!response.ok) throw new Error(`HTTP ${response.status}`);

          let data = await response.json();
          if (Array.isArray(data)) data = data[0];

          state.results.push({
            category,
            beforeUrl: imageData.preview,
            afterUrl: data.generated_image?.url || '',
            analysis: data.room_analysis || 'ë¶„ì„ ê²°ê³¼ ì—†ìŒ',
            suggestions: data.design_suggestions || 'ì œì•ˆ ì—†ìŒ'
          });

        } catch (error) {
          console.error(`Error generating ${category}:`, error);
          state.results.push({
            category,
            beforeUrl: imageData.preview,
            afterUrl: '',
            analysis: 'ìƒì„± ì‹¤íŒ¨',
            suggestions: error.message
          });
        }
      }

      hideProgress();
      loading.classList.remove('active');
      
      // Render result pages
      renderResultPages();
      
      btn.disabled = false;
      btn.innerHTML = 'âœ¨ AI ë””ìì¸ ìƒì„±';
      updateButtons();

      document.getElementById('downloadBtn').disabled = false;
      document.getElementById('shareBtn').disabled = false;

      showToast(`${state.results.length}ê°œ ë””ìì¸ ìƒì„± ì™„ë£Œ!`, 'success');
      addChatMessage(`ğŸ‰ ${state.results.length}ê°œì˜ ê³µê°„ ë””ìì¸ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ê²°ê³¼ë¥¼ í™•ì¸í•´ë³´ì„¸ìš”.`, false);

      document.querySelector('.result-section').scrollIntoView({ behavior: 'smooth' });
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // RENDER RESULT PAGES
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function renderResultPages() {
      const pagesContainer = document.getElementById('resultPages');
      const pageNav = document.getElementById('pageNav');
      const pageIndicator = document.getElementById('pageIndicator');

      pagesContainer.innerHTML = '';

      if (state.results.length === 0) return;

      // Create pages
      state.results.forEach((result, index) => {
        const page = document.createElement('div');
        page.className = `result-page ${index === 0 ? 'active' : ''}`;
        page.dataset.index = index;

        const info = categoryInfo[result.category];

        page.innerHTML = `
          <div class="page-category">
            <span class="icon">${info.icon}</span>
            ${info.name}
          </div>
          
          <div class="result-grid">
            <div class="result-card">
              <div class="result-card-header">
                <div class="dot before"></div>
                <span>Before - ì›ë³¸</span>
              </div>
              <img src="${result.beforeUrl}" alt="Before">
            </div>
            <div class="result-card">
              <div class="result-card-header">
                <div class="dot after"></div>
                <span>After - AI ë¦¬ë””ìì¸</span>
              </div>
              <img src="${result.afterUrl || 'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2280%22>âŒ</text></svg>'}" alt="After" 
                   onclick="${result.afterUrl ? `window.open('${result.afterUrl}', '_blank')` : ''}"
                   style="cursor: ${result.afterUrl ? 'pointer' : 'default'}">
            </div>
          </div>
          
          <div class="result-analysis">
            <div class="analysis-card">
              <h4>ğŸ“Š ê³µê°„ ë¶„ì„</h4>
              <p>${result.analysis}</p>
            </div>
            <div class="analysis-card">
              <h4>ğŸ’¡ ë””ìì¸ ì œì•ˆ</h4>
              <p>${result.suggestions}</p>
            </div>
          </div>
        `;

        pagesContainer.appendChild(page);
      });

      // Update page navigation
      if (state.results.length > 1) {
        pageNav.classList.remove('hidden');
        
        // Create dots
        pageIndicator.innerHTML = state.results.map((_, i) => 
          `<div class="page-dot ${i === 0 ? 'active' : ''}" onclick="goToPage(${i})"></div>`
        ).join('');
        
        document.getElementById('totalPages').textContent = state.results.length;
        updatePageNav();
      } else {
        pageNav.classList.add('hidden');
      }

      state.currentPage = 0;
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // PAGE NAVIGATION
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function changePage(delta) {
      const newPage = state.currentPage + delta;
      if (newPage >= 0 && newPage < state.results.length) {
        goToPage(newPage);
      }
    }

    function goToPage(index) {
      state.currentPage = index;
      
      // Update active page
      document.querySelectorAll('.result-page').forEach((page, i) => {
        page.classList.toggle('active', i === index);
      });
      
      // Update dots
      document.querySelectorAll('.page-dot').forEach((dot, i) => {
        dot.classList.toggle('active', i === index);
      });
      
      updatePageNav();
    }

    function updatePageNav() {
      document.getElementById('currentPage').textContent = state.currentPage + 1;
      document.getElementById('prevPage').disabled = state.currentPage === 0;
      document.getElementById('nextPage').disabled = state.currentPage === state.results.length - 1;
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Download & Share
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function downloadCurrentImage() {
      const result = state.results[state.currentPage];
      if (!result?.afterUrl) {
        showToast('ë‹¤ìš´ë¡œë“œí•  ì´ë¯¸ì§€ê°€ ì—†ìŠµë‹ˆë‹¤.', 'error');
        return;
      }
      
      const link = document.createElement('a');
      link.href = result.afterUrl;
      link.target = '_blank';
      link.download = `dadam-${result.category}-design.png`;
      link.click();
      showToast('ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ ì‹œì‘', 'success');
    }

    async function shareResult() {
      const result = state.results[state.currentPage];
      if (!result?.afterUrl) return;
      
      try {
        if (navigator.share) {
          await navigator.share({
            title: `ë‹¤ë‹´ê°€êµ¬ AI ë¦¬ë””ìì¸ - ${categoryInfo[result.category].name}`,
            text: `${categoryInfo[result.category].name}ë¥¼ "${state.selectedStyle}" ìŠ¤íƒ€ì¼ë¡œ ë¦¬ë””ìì¸í–ˆì–´ìš”!`,
            url: result.afterUrl
          });
        } else {
          await navigator.clipboard.writeText(result.afterUrl);
          showToast('URLì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
        }
      } catch (e) {
        showToast('ê³µìœ í•˜ê¸° ì‹¤íŒ¨', 'error');
      }
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Chat
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function addChatMessage(content, isUser = false) {
      const chatMessages = document.getElementById('chatMessages');
      const welcome = chatMessages.querySelector('.welcome-msg');
      if (welcome) welcome.remove();

      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${isUser ? 'user' : 'ai'}`;
      messageDiv.innerHTML = `
        <div class="message-avatar">
          <svg fill="${isUser ? 'none' : 'currentColor'}" stroke="${isUser ? 'currentColor' : 'none'}" stroke-width="2">
            <use href="#icon-${isUser ? 'user' : 'ai'}"/>
          </svg>
        </div>
        <div class="message-content">${content}</div>
      `;
      chatMessages.appendChild(messageDiv);
      chatMessages.scrollTop = chatMessages.scrollHeight;

      const messages = chatMessages.querySelectorAll('.message');
      if (messages.length > 3) messages[0].remove();
    }

    async function sendMessage() {
      const input = document.getElementById('messageInput');
      const message = input.value.trim();
      if (!message) return;

      addChatMessage(message, true);
      input.value = '';

      try {
        const response = await fetch(N8N_CHAT_URL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ message })
        });
        const data = await response.json();
        addChatMessage(data.response || data.output || 'ì‘ë‹µì„ ì²˜ë¦¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', false);
      } catch (error) {
        addChatMessage('ì¼ì‹œì ì¸ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', false);
      }
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Toast
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    function showToast(message, type = 'info') {
      const toast = document.getElementById('toast');
      toast.textContent = message;
      toast.className = `toast ${type} show`;
      setTimeout(() => toast.classList.remove('show'), 3000);
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Keyboard Navigation
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    document.addEventListener('keydown', (e) => {
      if (state.results.length > 1) {
        if (e.key === 'ArrowLeft') changePage(-1);
        if (e.key === 'ArrowRight') changePage(1);
      }
    });

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Touch Swipe for Pages
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    let touchStartX = 0;
    document.getElementById('resultPages').addEventListener('touchstart', (e) => {
      touchStartX = e.changedTouches[0].screenX;
    }, { passive: true });

    document.getElementById('resultPages').addEventListener('touchend', (e) => {
      const diff = touchStartX - e.changedTouches[0].screenX;
      if (Math.abs(diff) > 50) {
        changePage(diff > 0 ? 1 : -1);
      }
    }, { passive: true });

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // Init
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    document.addEventListener('DOMContentLoaded', updateButtons);
  </script>
</body>
</html>
